Основные правила поведения призраков

Призраки думают лишь на один шаг в будущее, когда движутся в лабиринте. Всякий раз, когда призрак ступает на клетку он смотрит вперед на следующую и смотрит куда он повернет, когда достигнет ее. Эти решения имеют одно очень важное ограничение: призраки никогда не могут изменить направление движения на противоположное. То есть призрак не может войти на клетку с левой стороны, а затем решить начать двигаться в обраном направлении и выйти слева. Смысл этого ограничения в том, что когда призрак входит на клетку лишь с двумя выходами, он не может выбрать тот, откуда пришел, и всегда будет продолжать идти в том же направлении.

Однако, есть одно исключение из этого правила: когда призраки изменяют режим с преследования или разбегания на любой другой, они обязаны изменить свое направление как только перейдут на следующую клетку. Это обязательство отменяет любое решение о предыдущем направлении движения. Это действует как эффективное уведомление для игрока, что призраки изменили свой режим, так как это единственный раз, когда возможно такое поведение. Заметьте, что когда они покидают режим испуга, они не меняют направление. Итак, 1/60-секундный режим на каждом уровне после первого заставляет всех призраков пересмотреть свое направление движения, даже если их цель осталась там же. Кстати, такое же поведение специально прописано для призраков в «домике», так призрак, который не вышел из домика за время первого переключения режимов, выйдет из него в обратном направлении. Это заставляет их двигаться влево как обычно, а потом сразу изменить направление и пойти вправо.

Когда необходимо принять решение, призрак выбирает прилегающую клетку, которая поставит его ближе по прямой линии к цели. Измеряется расстояние от возможной клетки движения до целевой и выбирает та, которая ближе. Призрак развернется вверх на перекрестке, если две клетки находятся на одинаковом расстоянии от цели, то выбирается по приоритетам: верхняя > левой > нижней. При таком способе выбора, решение пойти вправо не может быть принято никогда, так как любой другой вариант точно будет лучше.

Так как расстояние выбирается по прямой до цели, возможно, что призрак выберет неправильный поворот, когда расстояние по прямой меньше, однако расстояние по лабиринту может оказаться больше. Пример показан ниже, где измерение по прямой дает выход налево, однако это не является лучшим выбором. Это даст нам 28 клеток для достижения цели, однако путь вправо занял бы всего 8.

Индивидуальные аспекты поведения

Единственные отличия между привидениями — это их метод выбора целевых клеток в режиме преследования и разбегания. Сначала посмотрим как призраки ведут себя в режиме разбегания, так как это очень просто, а затем посмотрим на их подход к передвижению в режиме преследования.

Режим разбегания

В этом режиме каждый призрак имеет предопределенную целевую клетку, расположенную за границами лабиринта около углов. Когда начинается этот режим, каждый призрак поворачивает голову в сторону целевого угла и начинает движение согласно обычному алгоритма поиска пути. Однако, поскольку их цели недоступны, а призраки не могут остановиться или развернуться, они начинают пытаться достичь свою цель, разворачиваясь и возвращаясь к ней снова. В результате чего путь каждого привидения со временем превращается в петлю около своего угла. Если оставаться в режиме разбегания, они будут крутиться по ней бесконечно. На практике же режим разбегания настолько короток, что привидения даже не успевают достичь своих углов или сделать полный оборот по своей петле. На схеме ниже изображены целевые клетки каждого персонажа и петли, которые они описывали бы.

Подробнее можно прочитать здесь: https://habr.com/ru/post/109406/